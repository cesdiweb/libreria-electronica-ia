<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Carrito - Librer√≠a Electr√≥nica IA</title>
<style>
body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f3f6fa; color:#222; }
header { background-color: #004080; color:white; padding:1rem; text-align:center; }
nav { display:flex; justify-content:center; gap:1rem; background-color:#0066cc; padding:0.5rem; }
nav a { color:white; text-decoration:none; font-weight:bold; }
.selector-container { display:flex; justify-content:center; gap:1rem; margin:1rem; flex-wrap:wrap; }
.selector-container select { padding:0.5rem; border-radius:5px; }
.carrito-container { max-width:800px; margin:2rem auto; background:white; padding:1rem; border-radius:10px; box-shadow:0 2px 8px rgba(0,0,0,0.1); }
.item { display:flex; justify-content:space-between; align-items:center; padding:0.5rem 0; border-bottom:1px solid #ccc; }
.item:last-child { border-bottom:none; }
.item button { padding:0.3rem 0.5rem; margin:0 0.2rem; }
.total { text-align:right; font-weight:bold; margin-top:1rem; }
.empty-msg { text-align:center; padding:2rem; font-style:italic; }
</style>
</head>
<body>
<header>
<h1>Electronic Bookstore AI</h1>
<p>Your smart and international digital bookstore</p>
</header>
<nav>
<a href="index.html">Inicio</a>
<a href="register.html">Registrarse</a>
<a href="login.html">Iniciar Sesi√≥n</a>
<a href="contacto.html">Contacto</a>
<a href="carrito.html">üõí Carrito</a>
</nav>

<div class="selector-container">
<label>üåé Pa√≠s:
<select id="country" aria-label="Pa√≠s"></select>
</label>
<label>üó£Ô∏è Idioma:
<select id="language" aria-label="Idioma"></select>
</label>
<label>üí∞ Moneda:
<select id="currency" aria-label="Moneda"></select>
</label>
</div>

<div class="carrito-container" id="carrito-container">
<!-- Items del carrito se mostrar√°n aqu√≠ -->
</div>

<script>
// Copiar exchangeRates, countriesData y languageNames desde index.html
const exchangeRates = { /* ...pega todo tu bloque de exchangeRates aqu√≠... */ };
const countriesData = [ /* ...pega todo tu bloque countriesData aqu√≠... */ ];
const languageNames = { /* ...pega todo tu bloque languageNames aqu√≠... */ };

// Selects
const countrySelect = document.getElementById("country");
const languageSelect = document.getElementById("language");
const currencySelect = document.getElementById("currency");

// Llenado de selects (igual que index.html)
countrySelect.innerHTML = "";
languageSelect.innerHTML = "";
currencySelect.innerHTML = "";
countriesData.sort((a,b)=>a.name.localeCompare(b.name,"es",{sensitivity:"base"}));
countriesData.forEach(country=>{
  countrySelect.innerHTML += `<option value="${country.code}">${country.name}</option>`;
  if(!languageSelect.querySelector(`option[value="${country.language}"]`)){
    languageSelect.innerHTML += `<option value="${country.language}">${languageNames[country.language]||country.language}</option>`;
  }
  if(!currencySelect.querySelector(`option[value="${country.currency}"]`)){
    currencySelect.innerHTML += `<option value="${country.currency}">${country.currency}</option>`;
  }
});

// Cargar selecci√≥n de localStorage
let savedCountry = localStorage.getItem("selectedCountry") || "CO";
let savedLanguage = localStorage.getItem("selectedLanguage") || "es";
let savedCurrency = localStorage.getItem("selectedCurrency") || "COP $";
countrySelect.value = savedCountry;
languageSelect.value = savedLanguage;
currencySelect.value = savedCurrency;

// Eventos para selects
countrySelect.addEventListener("change",()=>{
  const sel=countriesData.find(c=>c.code===countrySelect.value);
  if(!sel) return;
  languageSelect.value=sel.language;
  currencySelect.value=sel.currency;
  localStorage.setItem("selectedCountry",sel.code);
  localStorage.setItem("selectedLanguage",sel.language);
  localStorage.setItem("selectedCurrency",sel.currency);
  mostrarCarrito();
});
languageSelect.addEventListener("change",()=>localStorage.setItem("selectedLanguage",languageSelect.value));
currencySelect.addEventListener("change",()=>{localStorage.setItem("selectedCurrency",currencySelect.value); mostrarCarrito();});

// Mostrar carrito
function mostrarCarrito(){
  const cont=document.getElementById("carrito-container");
  let carrito=JSON.parse(localStorage.getItem("carrito"))||[];
  const currencyLabel = currencySelect.value;
  const currencyCode = currencyLabel.split(' ')[0];
  const rate = exchangeRates[currencyCode] || 1;
  if(carrito.length===0){ cont.innerHTML='<p class="empty-msg">El carrito est√° vac√≠o.</p>'; return; }

  let html='';
  let total=0;
  carrito.forEach((item,index)=>{
    const precioConv = Math.round(item.precio*rate);
    total+=precioConv*item.cantidad;
    html+=`
    <div class="item">
      <span>${item.titulo} √ó ${item.cantidad}</span>
      <span>${currencyLabel} ${precioConv*item.cantidad}</span>
      <span>
        <button onclick="cambiarCantidad(${index},1)">Ôºã</button>
        <button onclick="cambiarCantidad(${index},-1)">‚àí</button>
        <button onclick="eliminarItem(${index})">üóëÔ∏è</button>
      </span>
    </div>`;
  });
  html+=`<div class="total">Total: ${currencyLabel} ${total}</div>`;
  cont.innerHTML=html;
}

// Funciones para actualizar carrito
function cambiarCantidad(i,delta){
  let carrito=JSON.parse(localStorage.getItem("carrito"))||[];
  carrito[i].cantidad+=delta;
  if(carrito[i].cantidad<1) carrito[i].cantidad=1;
  localStorage.setItem("carrito",JSON.stringify(carrito));
  mostrarCarrito();
}
function eliminarItem(i){
  let carrito=JSON.parse(localStorage.getItem("carrito"))||[];
  carrito.splice(i,1);
  localStorage.setItem("carrito",JSON.stringify(carrito));
  mostrarCarrito();
}

// Inicializar
mostrarCarrito();
</script>
</body>
</html>

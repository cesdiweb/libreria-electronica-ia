const countrySelect = document.getElementById("country");
    const languageSelect = document.getElementById("language");
    const currencySelect = document.getElementById("currency");

    countriesData.forEach(country => {
      countrySelect.innerHTML += `<option value="${country.code}">${country.name}</option>`;

      if (!languageSelect.querySelector(`option[value='${country.language}']`)) {
        const langName = languageNames[country.language] || country.language;
        languageSelect.innerHTML += `<option value="${country.language}">${langName}</option>`;
      }

      if (!currencySelect.querySelector(`option[value='${country.currency}']`)) {
        currencySelect.innerHTML += `<option value="${country.currency}">${country.currency}</option>`;
      }
    });

    function updatePrices(symbol) {
      const prices = document.querySelectorAll(".price");
      prices.forEach(el => {
        const base = el.getAttribute("data-base");
        el.textContent = `${symbol} ${base}`;
      });
    }

    countrySelect.onchange = () => {
      const country = countrySelect.value;
      const selected = countriesData.find(c => c.code === country);
      languageSelect.value = selected.language;
      currencySelect.value = selected.currency;
      localStorage.setItem('country', country);
      localStorage.setItem('language', selected.language);
      localStorage.setItem('currency', selected.currency);
      updatePrices(selected.currency);
    };

    languageSelect.onchange = () => {
      localStorage.setItem('language', languageSelect.value);
      alert("Idioma cambiado a: " + (languageNames[languageSelect.value] || languageSelect.value));
    };

    currencySelect.onchange = () => {
      localStorage.setItem('currency', currencySelect.value);
      updatePrices(currencySelect.value);
    };
fetch("https://ipapi.co/json/")
  .then(response => response.json())
  .then(data => {
    const countryCode = data.country_code || "CO";
    const countryData = countriesData.find(c => c.code === countryCode);

    if (countryData) {
      localStorage.setItem("country", countryData.code);
      localStorage.setItem("language", countryData.language);
      localStorage.setItem("currency", countryData.currency);
    }
  })
  .catch(error => console.error("Error al detectar ubicaci칩n por IP:", error));


    window.onload = () => {
      const savedCountry = localStorage.getItem("country") || "CO";
      const savedLanguage = localStorage.getItem("language") || "es";
      const savedCurrency = localStorage.getItem("currency") || "COP $";

      countrySelect.value = savedCountry;
      languageSelect.value = savedLanguage;
      currencySelect.value = savedCurrency;
      updatePrices(savedCurrency);
aplicarTraduccion();

    };
const translations = {
  es: {
    "Inicio": "Inicio",
    "Cat치logo": "Cat치logo",
    "Registrarse": "Registrarse",
    "Iniciar Sesi칩n": "Iniciar Sesi칩n",
    "Contacto": "Contacto",
    "Agregar al carrito": "Agregar al carrito",
    "Tu librer칤a digital inteligente e internacional": "Tu librer칤a digital inteligente e internacional"
  },
  en: {
    "Inicio": "Home",
    "Cat치logo": "Catalog",
    "Registrarse": "Register",
    "Iniciar Sesi칩n": "Login",
    "Contacto": "Contact",
    "Agregar al carrito": "Add to cart",
    "Tu librer칤a digital inteligente e internacional": "Your smart and international digital bookstore"
  },
  fr: {
    "Inicio": "Accueil",
    "Cat치logo": "Catalogue",
    "Registrarse": "S'inscrire",
    "Iniciar Sesi칩n": "Connexion",
    "Contacto": "Contact",
    "Agregar al carrito": "Ajouter au panier",
    "Tu librer칤a digital inteligente e internacional": "Votre librairie num칠rique intelligente et internationale"
  },
  // puedes a침adir m치s idiomas despu칠s
};

function aplicarTraduccion() {
  const lang = localStorage.getItem('language') || 'es';
  const dict = translations[lang];
  if (!dict) return;

  document.querySelectorAll("nav a, .carrito-btn, header p").forEach(el => {
    if (dict[el.textContent]) {
      el.textContent = dict[el.textContent];
    }
  });
}

  </script>
function agregarAlCarrito(titulo, autor, precio, moneda) {
  const carrito = JSON.parse(localStorage.getItem("carrito")) || [];

  const producto = {
    titulo,
    autor,
    precio,
    moneda,
    cantidad: 1
  };

  // Verifica si ya est치 en el carrito
  const existente = carrito.find(item => item.titulo === titulo && item.moneda === moneda);
  if (existente) {
    existente.cantidad += 1;
  } else {
    carrito.push(producto);
  }

  localStorage.setItem("carrito", JSON.stringify(carrito));
  alert(`游닄 ${titulo} a침adido al carrito.`);
}

</body>
</html>
